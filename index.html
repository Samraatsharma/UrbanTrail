<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>UrbanTrail Smart Navigator</title>

  <!-- Mobile / PWA Meta Tags -->
  <meta name="theme-color" content="#060912" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="UrbanTrail" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />

  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 28 28'><circle cx='14' cy='14' r='14' fill='%233B82F6'/><path d='M14 6L18 13H10L14 6Z' fill='white'/><path d='M14 22L10 15H18L14 22Z' fill='rgba(255,255,255,0.6)'/></svg>" />
  <meta name="description"
    content="Premium AI-assisted smart navigation with real-time GPS, multi-route planning, fuel estimates, and live voice guidance." />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <!-- Google Fonts: Outfit (headings) + Inter (body) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet" />
  <!-- App CSS -->
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>

  <!-- ═══ ANIMATED BACKGROUND CANVAS ════════════════════════════ -->
  <canvas id="bg-canvas"></canvas>

  <!-- ═══ CINEMATIC LOADER ═══════════════════════════════════════ -->
  <div id="app-loader">
    <div class="loader-core">
      <div class="loader-rings">
        <div class="lr lr1"></div>
        <div class="lr lr2"></div>
        <div class="lr lr3"></div>
      </div>
      <div class="loader-icon">
        <svg width="36" height="36" viewBox="0 0 28 28" fill="none">
          <circle cx="14" cy="14" r="14" fill="url(#loaderG)" />
          <path d="M14 6L18 13H10L14 6Z" fill="white" />
          <path d="M14 22L10 15H18L14 22Z" fill="rgba(255,255,255,0.5)" />
          <defs>
            <linearGradient id="loaderG" x1="0" y1="0" x2="28" y2="28" gradientUnits="userSpaceOnUse">
              <stop stop-color="#3B82F6" />
              <stop offset="1" stop-color="#8B5CF6" />
            </linearGradient>
          </defs>
        </svg>
      </div>
    </div>
    <p class="loader-text">UrbanTrail</p>
    <span class="loader-sub">Initializing Smart Navigator…</span>
    <div class="loader-progress">
      <div class="loader-bar"></div>
    </div>
  </div>

  <!-- ═══ TOPBAR ══════════════════════════════════════════════════ -->
  <header id="topbar">
    <div class="brand">
      <div class="brand-logo">
        <svg width="32" height="32" viewBox="0 0 28 28" fill="none">
          <circle cx="14" cy="14" r="14" fill="url(#topG)" />
          <path d="M14 6L18 13H10L14 6Z" fill="white" />
          <path d="M14 22L10 15H18L14 22Z" fill="rgba(255,255,255,0.5)" />
          <defs>
            <linearGradient id="topG" x1="0" y1="0" x2="28" y2="28" gradientUnits="userSpaceOnUse">
              <stop stop-color="#3B82F6" />
              <stop offset="1" stop-color="#8B5CF6" />
            </linearGradient>
          </defs>
        </svg>
      </div>
      <div class="brand-text">
        <span class="brand-name">UrbanTrail</span>
        <span class="brand-tag">Smart Navigator</span>
      </div>
    </div>
    <div class="topbar-actions">
      <!-- Language Toggle -->
      <div class="lang-toggle" id="lang-toggle" title="Switch Language">
        <span class="lang-opt active" data-lang="en">EN</span>
        <div class="lang-slider"></div>
        <span class="lang-opt" data-lang="hi">हि</span>
      </div>
      <!-- Theme Toggle -->
      <button class="icon-btn" id="theme-toggle" title="Toggle Dark/Light Mode" aria-label="Toggle theme">
        <svg id="theme-icon-dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
          stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
        </svg>
        <svg id="theme-icon-light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
          stroke-width="2" style="display:none">
          <circle cx="12" cy="12" r="5" />
          <line x1="12" y1="1" x2="12" y2="3" />
          <line x1="12" y1="21" x2="12" y2="23" />
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
          <line x1="1" y1="12" x2="3" y2="12" />
          <line x1="21" y1="12" x2="23" y2="12" />
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
        </svg>
      </button>
      <!-- Panel Toggle -->
      <button class="icon-btn" id="panel-toggle" title="Toggle Route Panel" aria-label="Toggle panel">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="18" rx="1" />
          <rect x="14" y="3" width="7" height="18" rx="1" />
        </svg>
      </button>
    </div>
  </header>

  <!-- ═══ MAIN LAYOUT ════════════════════════════════════════════ -->
  <main id="main-layout">

    <!-- ─── MAP CONTAINER ──────────────────────────────────────── -->
    <div id="map-wrap">
      <div id="map"></div>

      <!-- Floating Search Panel -->
      <div id="search-panel" class="glass-panel">
        <div class="sp-header">
          <div class="sp-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
              <circle cx="12" cy="10" r="3" />
            </svg>
          </div>
          <h2 class="panel-title" data-i18n="panel_title">Plan Your Route</h2>
        </div>
        <div id="city-badge"></div>

        <!-- Source -->
        <div class="input-group">
          <label data-i18n="label_from">FROM</label>
          <div class="autocomplete-wrap">
            <div class="inp-dot inp-dot-a"></div>
            <input type="text" id="source-input" class="ac-input" placeholder="Search source location…"
              autocomplete="off" />
            <div class="ac-dropdown" id="source-dropdown"></div>
          </div>
          <button class="gps-btn" id="gps-btn" title="Use My Live Location">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="15" height="15">
              <path d="M12 2a10 10 0 1 0 0 20A10 10 0 0 0 12 2zm0 0v4m0 16v-4m10-6h-4M6 12H2" />
              <circle cx="12" cy="12" r="3" fill="currentColor" />
            </svg>
            <span data-i18n="btn_gps">My Location</span>
          </button>
        </div>

        <div class="route-connector">
          <div class="rc-line"></div>
          <div class="rc-dot"></div>
        </div>

        <!-- Destination -->
        <div class="input-group">
          <label data-i18n="label_to">TO</label>
          <div class="autocomplete-wrap">
            <div class="inp-dot inp-dot-b"></div>
            <input type="text" id="dest-input" class="ac-input" placeholder="Search destination…" autocomplete="off" />
            <div class="ac-dropdown" id="dest-dropdown"></div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="btn-row">
          <button class="btn btn-primary" id="find-routes-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="16" height="16">
              <circle cx="11" cy="11" r="8" />
              <line x1="21" y1="21" x2="16.65" y2="16.65" />
            </svg>
            <span data-i18n="btn_find">Find Routes</span>
          </button>
          <button class="btn btn-ghost" id="clear-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="15" height="15">
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>

        <!-- Status -->
        <div id="status-bar" class="status-bar" style="display:none"></div>
      </div>

      <!-- Navigation HUD (shown during active navigation) -->
      <div id="nav-hud" class="nav-hud" style="display:none">
        <div class="hud-tilt-bar">
          <div class="htb-left">
            <div class="hud-compass">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                <circle cx="12" cy="12" r="10" />
                <polygon points="12,2 14.5,10 12,8 9.5,10" fill="#EF4444" stroke="none" />
                <polygon points="12,22 14.5,14 12,16 9.5,14" fill="white" stroke="none" />
              </svg>
            </div>
            <span class="hud-route-name" id="hud-route-name">Navigating…</span>
          </div>
          <button class="hud-exit-btn" id="stop-nav-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="14" height="14">
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
            Exit
          </button>
        </div>
        <div class="hud-body">
          <div class="hud-speed-block">
            <span id="hud-speed-val">0</span>
            <small>km/h</small>
          </div>
          <div class="hud-vdivider"></div>
          <div class="hud-stats">
            <div class="hud-stat">
              <span class="hud-label" data-i18n="hud_dist">Distance Left</span>
              <strong id="hud-dist-val">--</strong>
            </div>
            <div class="hud-stat">
              <span class="hud-label" data-i18n="hud_eta">ETA</span>
              <strong id="hud-eta-val">--</strong>
            </div>
          </div>
        </div>
        <div class="hud-instruction">
          <div class="hud-arrow">
            <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
              <path d="M12 2l-7 7h4v8h6v-8h4z" />
            </svg>
          </div>
          <span id="hud-instruction-text">Starting navigation…</span>
        </div>
        <div class="hud-progress-track">
          <div class="hud-progress-fill" id="hud-progress-fill"></div>
        </div>
      </div>
    </div>

    <!-- ─── RIGHT PANEL ──────────────────────────────────────── -->
    <aside id="right-panel">
      <div class="panel-header">
        <div class="ph-title">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
            <path d="M3 12h18M3 6h18M3 18h18" />
          </svg>
          <h3 data-i18n="routes_title">Routes</h3>
        </div>
        <span class="route-count-badge" id="route-count"></span>
      </div>

      <div id="route-cards-wrap">
        <div class="panel-empty" id="panel-empty">
          <div class="pe-graphic">
            <div class="pe-circle pe-c1"></div>
            <div class="pe-circle pe-c2"></div>
            <svg viewBox="0 0 64 64" fill="none" width="40" height="40" class="pe-icon">
              <path d="M20 32h24M32 20l12 12-12 12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
          <p data-i18n="empty_panel">Enter locations to discover routes</p>
        </div>
      </div>

      <div id="nav-controls" style="display:none">
        <div class="nav-controls-inner">
          <button class="btn btn-nav" id="start-nav-btn">
            <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
              <polygon points="5,3 19,12 5,21" />
            </svg>
            <span data-i18n="btn_start_nav">Start Navigation</span>
          </button>
          <button class="btn btn-voice" id="voice-toggle-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
              <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
              <line x1="12" y1="19" x2="12" y2="23" />
            </svg>
            <span id="voice-btn-text" data-i18n="btn_voice_on">Voice: ON</span>
          </button>
        </div>
      </div>
    </aside>
  </main>

  <!-- ═══ TOAST NOTIFICATIONS ════════════════════════════════════ -->
  <div id="toast-container"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- Animated background canvas script (inlined small) -->
  <script>
    (function () {
      const canvas = document.getElementById('bg-canvas');
      const ctx = canvas.getContext('2d');
      let W, H, particles = [], raf;

      function resize() {
        W = canvas.width = window.innerWidth;
        H = canvas.height = window.innerHeight;
      }

      function mkParticle() {
        return {
          x: Math.random() * W,
          y: Math.random() * H,
          r: Math.random() * 1.5 + 0.4,
          vx: (Math.random() - 0.5) * 0.25,
          vy: (Math.random() - 0.5) * 0.25,
          o: Math.random() * 0.4 + 0.1
        };
      }

      function init() {
        resize();
        particles = Array.from({ length: 80 }, mkParticle);
      }

      function draw() {
        ctx.clearRect(0, 0, W, H);
        // Draw connections
        for (let i = 0; i < particles.length; i++) {
          for (let j = i + 1; j < particles.length; j++) {
            const dx = particles[i].x - particles[j].x;
            const dy = particles[i].y - particles[j].y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < 130) {
              ctx.beginPath();
              ctx.strokeStyle = `rgba(99,130,246,${0.08 * (1 - dist / 130)})`;
              ctx.lineWidth = 0.7;
              ctx.moveTo(particles[i].x, particles[i].y);
              ctx.lineTo(particles[j].x, particles[j].y);
              ctx.stroke();
            }
          }
        }
        // Draw particles
        particles.forEach(p => {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(120,150,255,${p.o})`;
          ctx.fill();
          p.x += p.vx; p.y += p.vy;
          if (p.x < 0 || p.x > W) p.vx *= -1;
          if (p.y < 0 || p.y > H) p.vy *= -1;
        });
        raf = requestAnimationFrame(draw);
      }

      init();
      draw();
      window.addEventListener('resize', () => { resize(); });
    })();
  </script>
  <!-- App JS -->
  <script src="js/app.js"></script>
</body>

</html>